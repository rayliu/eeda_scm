package controllers.eeda;import java.util.Calendar;import java.util.Date;import java.util.List;import models.eeda.Case;import models.eeda.Leads;import org.apache.shiro.SecurityUtils;import org.apache.shiro.subject.Subject;import com.jfinal.core.Controller;import com.jfinal.log.Logger;import com.jfinal.plugin.activerecord.Db;import com.jfinal.plugin.activerecord.Record;public class CaseController extends Controller {	private Logger logger = Logger.getLogger(CaseController.class);	Subject currentUser = SecurityUtils.getSubject();	private boolean isAuthenticated() {		if (!currentUser.isAuthenticated()) {			redirect("/login");			return false;		}		setAttr("userId", currentUser.getPrincipal());		return true;	}	public void index() {		if (!isAuthenticated())			return;		List<Record> leadsList = Db.find("select * from support_case order by create_date desc");		System.out.println("size:" + leadsList.size());		setAttr("caseList", leadsList).render("/eeda/caseList.html");	}	public void newCase() {		if (!isAuthenticated())			return;		render("/eeda/caseForm.html");	}	public void editCase() {		if (!isAuthenticated())			return;		String id = getPara();		if (id != null) {			Leads l = Leads.dao.findById(id);			setAttr("leads", l);		}		render("/eeda/leadsForm.html");	}	public void saveCase() {		if (!isAuthenticated())			return;		Case requestCase = null;		String id = getPara("caseId");		if (id != "") {			requestCase = Case.dao.findById(id);		} else {			requestCase = new Case();		}		requestCase.set("title", getPara("title"));		requestCase.set("type", getPara("type"));		requestCase.set("case_desc", getPara("case_desc"));		requestCase.set("note", getPara("note"));		requestCase.set("status", getPara("status"));		requestCase.set("creator", currentUser.getPrincipal());		Date createDate = Calendar.getInstance().getTime();		requestCase.set("create_Date", createDate);		if (id != "") {			requestCase.update();		} else {			requestCase.save();		}		index();	}}